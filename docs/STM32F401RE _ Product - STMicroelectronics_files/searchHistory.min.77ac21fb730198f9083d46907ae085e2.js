function sliceResults(c,b){c.length>b&&(c=c.slice(0,b));return c}var App=angular.module("stSearchHistoryApp",["ngSanitize","ngCookies"]);
App.controller("searchHistoryController",["$scope","$http","$window","$cookies",function(c,b,f,g){c.form={};c.items="";c.getSearchHistory=function(a){a?(a=STUtils.generateGuid(),a="/bin/st/search-cx/servlets/searchhistory.json?rand\x3d"+(new Date).getTime()+"\x26sessionId\x3d"+a,b({method:"GET",url:a,async:!0,headers:{"Content-Type":"application/x-www-form-urlencoded; charset\x3dUTF-8",Dispatcher:"no-cache","Cache-Control":"max-age\x3d0"}}).success(function(d){c.items=angular.fromJson(d.items)}).error(function(){console.log("error")})):
angular.forEach(g,function(d,e){"searchHistory"==e&&(d=angular.fromJson(d),c.items=angular.fromJson(d).sort(compare),c.$apply())})};c.searchHistoryResults=function(a){closePopoverSearch();var d=a.indexOf("q")+2,e=a.indexOf("\x26");d=a.substring(d,e);e=a.indexOf("category")+9;a='"]'!==a.substring(a.length-2)?a.substring(e,a.length):a.substring(e,a.length-2);sendSearchToGA(d);analyticsBookmarkHistoryClicked=1;changeTab(d,a,1,!0)}}]);var AppTop=angular.module("stSearchHistoryAppTop",["ngSanitize","ngCookies"]);
AppTop.controller("searchHistoryControllerTop",["$scope","$http","$window","$cookies",function(c,b,f,g){c.form={};c.items="";c.getSearchHistory=function(a){"true"==a?(a=STUtils.generateGuid(),a="/bin/st/search-cx/servlets/searchhistory.json?rand\x3d"+(new Date).getTime()+"\x26sessionId\x3d"+a,b({method:"GET",url:a,async:!0,headers:{"Content-Type":"application/x-www-form-urlencoded; charset\x3dUTF-8",Dispatcher:"no-cache","Cache-Control":"max-age\x3d0"}}).success(function(d){c.items=sliceResults(angular.fromJson(d.items),
3)}).error(function(){console.log("error")})):angular.forEach(g,function(d,e){"searchHistory"==e&&(d=angular.fromJson(d),c.items=sliceResults(angular.fromJson(d).sort(compare),3),c.$apply())})};c.searchHistoryResults=function(a){closeAutoSuggestionWidget();closeSearchWidget();var d=a.indexOf("q")+2,e=a.indexOf("\x26");d=a.substring(d,e);e=a.indexOf("category")+9;a='"]'!==a.substring(a.length-2)?a.substring(e,a.length):a.substring(e,a.length-2);"undefined"==typeof searchPageId?($(".searchKey_JS").val(d),
setCategoryFrom(a),$("#form-search").submit()):(sendSearchToGA(d),analyticsBookmarkHistoryClicked=1,changeTab(d,a,1,!0))}}]);var AppTopMobile=angular.module("stSearchHistoryAppTopMobile",["ngSanitize","ngCookies"]);
AppTopMobile.controller("searchHistoryControllerTopMobile",["$scope","$http","$window","$cookies",function(c,b,f,g){c.form={};c.items="";c.getSearchHistory=function(a){"true"==a?(a=STUtils.generateGuid(),a="/bin/st/search-cx/servlets/searchhistory.json?rand\x3d"+(new Date).getTime()+"\x26sessionId\x3d"+a,b({method:"GET",url:a,async:!0,headers:{"Content-Type":"application/x-www-form-urlencoded; charset\x3dUTF-8",Dispatcher:"no-cache","Cache-Control":"max-age\x3d0"}}).success(function(d){c.items=sliceResults(angular.fromJson(d.items),
3)}).error(function(){console.log("error")})):angular.forEach(g,function(d,e){"searchHistory"==e&&(d=angular.fromJson(d),c.items=sliceResults(angular.fromJson(d).sort(compare),3),c.$apply())})};c.searchHistoryResults=function(a){var d=a.indexOf("q")+2,e=a.indexOf("\x26");d=a.substring(d,e);e=a.indexOf("category")+9;a='"]'!==a.substring(a.length-2)?a.substring(e,a.length):a.substring(e,a.length-2);$("#categorySearchWidgetMobile").val(a);$(".searchKey_JS").val(d);$("#form-search-desktop").submit()}}]);
var transform=function(c){return $.param(c)};function compare(c,b){return c.searchDate<b.searchDate?1:c.searchDate>b.searchDate?-1:0}App.filter("getHtmlFilterFromHistory",["$sce",function(c){return function(b){var f=b.indexOf("q\x3d")+2,g=b.indexOf("\x26category\x3d");f=b.substring(f,g);b=b.substring(g+10);"]"===b.substring(b.length-1)&&(b=b.substring(0,b.length-2));"keywords"===b&&(b="all site");return c.trustAsHtml(f.replace(/\\"/g,'"')+"\x3cspan style\x3d'color: #8f8f8f'\x3e\x26nbsp;["+b+"]\x3c/span\x3e")}}]);
AppTop.filter("getHtmlFilterFromHistory",["$sce",function(c){return function(b){var f=b.indexOf("q\x3d")+2,g=b.indexOf("\x26category\x3d");f=b.substring(f,g);b=b.substring(g+10);"]"===b.substring(b.length-1)&&(b=b.substring(0,b.length-2));"keywords"===b&&(b="all site");return c.trustAsHtml(f.replace(/\\"/g,'"')+'\x3cspan class\x3d"st-text-color--grey"\x3e\x26nbsp;['+b+"]\x3c/span\x3e")}}]);
AppTopMobile.filter("getHtmlFilterFromHistory",["$sce",function(c){return function(b){var f=b.indexOf("q\x3d")+2,g=b.indexOf("\x26category\x3d");f=b.substring(f,g);b=b.substring(g+10);"]"===b.substring(b.length-1)&&(b=b.substring(0,b.length-2));"keywords"===b&&(b="all site");return c.trustAsHtml(f.replace(/\\"/g,'"')+'\x3cspan class\x3d"st-text-color--grey"\x3e\x26nbsp;['+b+"]\x3c/span\x3e")}}]);
window.addEventListener("load",function(c){angular.bootstrap(document.getElementById("divhistory"),["stSearchHistoryApp"]);angular.bootstrap(document.getElementById("searchfilter"),["stSearchHistoryAppTop"]);angular.bootstrap(document.getElementById("searchfilterMobile"),["stSearchHistoryAppTopMobile"])});